suicide25_lm <- lm(suicide25 ~
Jan+Feb+Mar+Apr+May+Jun+Jul+Aug+Sep+Oct+Nov,
data=ts_final_data)
ment24_lm <- lm(ment24 ~
Jan+Feb+Mar+Apr+May+Jun+Jul+Aug+Sep+Oct+Nov,
data=ts_final_data)
ment25_lm <- lm(ment25 ~
Jan+Feb+Mar+Apr+May+Jun+Jul+Aug+Sep+Oct+Nov,
data=ts_final_data)
suicide25_coef <- coef(summary(suicide25_lm))
suicide25_coef_coef_tibble <- bind_cols(var_name=rownames(suicide25_coef),
as_tibble(suicide25_coef)) %>%
clean_names()
suicide25_coef_coef_pretty_table <- suicide25_coef_coef_tibble %>%
filter(pr_t<=0.05) %>%
rename('P-value' = pr_t,
'Estimate'=estimate,
'Standard Error'=std_error,
'Test Statistic'=t_value,
'Variable Name'=var_name) %>%
dplyr::select('Variable Name',
'Estimate',
'Test Statistic',
'Standard Error',
'P-value') %>%
mutate_if(is.numeric, ~round(.,4))%>%
gt()
gt::gtsave(suicide25_coef_coef_pretty_table ,here('Plots', 'suicide25_coef.png'))
# Remove seasonal component from suicide variables
suicide24_decomp <- decompose(ts_final_data[,'suicide24'])
suicide24_sa <- suicide24_decomp$x - suicide24_decomp$seasonal
suicide25_decomp <- decompose(ts_final_data[,'suicide25'])
suicide25_sa <- suicide25_decomp$x - suicide25_decomp$seasonal
# Remove seasonal component from mental health variables
ment24_decomp <- decompose(ts_final_data[,'ment24'])
ment24_sa <- ment24_decomp$x - ment24_decomp$seasonal
ment25_decomp <- decompose(ts_final_data[,'ment25'])
ment25_sa <- ment25_decomp$x - ment25_decomp$seasonal
final_data_3 <- bind_cols(final_data_2,
suicide24_sa=suicide24_sa,
suicide25_sa=suicide25_sa,
ment24_sa=ment24_sa,
ment25_sa=ment25_sa)
final_data_3 <- final_data_3 %>%
dplyr::select(!month_num:Sep)
ba_vars <- c('ment24', 'ment24_sa', 'suicide24', 'suicide24_sa', 'ment25', 'ment25_sa', 'suicide25', 'suicide25_sa')
percents <- c(percents, 'ment24_sa', 'ment25_sa')
temp_list <- graph_vars(final_data_3, ba_vars, clean_names, dollars, percents, main_theme)
grid <- grid.arrange(grobs=temp_list, nrow=4,top='Before & After Seasonal Adjustment')
ggsave(here('Plots', 'ba_season_adjust.png'),plot=grid,dpi=300, width = 8, height = 11, units='in')
ts_final_data <- ts(final_data_3, start=c(1999,1), frequency=12)
# variables we will test for stationarity
stationarity_vars <- c('gen24',
'gen25',
'divorced',
'apple',
'atandt',
'verizon',
'unemp',
'savings',
'suicide24_sa',
'suicide25_sa',
'ment24_sa',
'ment25_sa')
stationarity_stats_1 <- test_station(ts_final_data, stationarity_vars)
nvar <- nrow(stationarity_stats_1)
nobs <- nrow(ts_final_data)
# remove the first variable because we adjusted for seasonality
final_data_3 <- final_data_3 %>%
filter(month_end!=ymd('1999-01-31'))
for(i in 1:nvar){
# If all four tests say that the data is stationary, don't adjust
if(stationarity_stats_1[i,'total_stationary']<4) {
var_name <- paste(stationarity_vars[i],'_station',sep='')
final_data_3 <- final_data_3 %>%
mutate(!!var_name:=diff(log(ts_final_data[,stationarity_vars[i]])))
}
}
stationarity_vars <- c('gen24_station',
'gen25_station',
'divorced_station',
'apple_station',
'atandt_station',
'verizon_station',
'unemp_station',
'savings_station',
'suicide24_sa_station',
'suicide25_sa_station',
'ment24_sa_station',
'ment25_sa_station')
ts_final_data <- ts(final_data_3, start=c(1999,2), frequency=12)
stationarity_stats_2 <- test_station(ts_final_data, stationarity_vars)
pretty_station_before <- pretty_station(stationarity_stats_1, clean_names)
pretty_station_after <- pretty_station(stationarity_stats_2, clean_names)
gt::gtsave(pretty_station_before ,here('Plots', 'stationarity_test_results_before.png'))
gt::gtsave(pretty_station_after ,here('Plots', 'stationarity_test_results_after.png'))
common_vars <- c('apple_station', 'atandt_station', 'verizon_station', 'divorced_station', 'savings_station', 'unemp_station')
age_vars <- c('gen24_station', 'ment24_sa_station', 'suicide24_sa_station', 'gen25_station', 'ment25_sa_station', 'suicide25_sa_station')
temp_list <- graph_vars(final_data_3, common_vars, clean_names, dollars, percents, main_theme)
grid <- grid.arrange(grobs=temp_list, nrow=2,top='Common Variables - Stationary')
ggsave(here('Plots', 'common_variables_stationary.png'),plot=grid,dpi=300, width = 11.5, height = 9, units='in')
temp_list <- graph_vars(final_data_3, age_vars, clean_names, dollars, percents, main_theme)
grid <- grid.arrange(grobs=temp_list, nrow=2,top='Age Variables - Stationary')
ggsave(here('Plots', 'age_variables_stationary.png'),plot=grid,dpi=300, width = 11.5, height = 9, units='in')
height <- 6
width <- 11.5
runs <- 500
out_months <- 36
temp_var_plots <- var_models(final_data_3,
c('gen24_station', 'ment24_sa_station'),
out_months = out_months,
response = 'suicide24_sa_station',
runs=runs,
against_self=T,
clean=clean_names)
grid <- grid.arrange(grobs=temp_var_plots, nrow=1,top='')
ggsave(here('Plots', 'age24only_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
temp_var_plots <- var_models(final_data_3,
c('ment24_sa_station', 'gen24_station'),
out_months = out_months,
response = 'suicide24_sa_station',
runs=runs,
against_self=T,
clean=clean_names)
grid <- grid.arrange(grobs=temp_var_plots, nrow=1,top='')
ggsave(here('Plots', 'age24only_reverse_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
temp_var_plots <- var_models(final_data_3,
c('apple_station', 'atandt_station', 'verizon_station', 'divorced_station'),
out_months = out_months,
response = 'suicide24_sa_station',
runs=runs,
against_self=F,
clean=clean_names)
grid <- grid.arrange(grobs=temp_var_plots, nrow=2,top='')
ggsave(here('Plots', 'age24commonSocietal_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
temp_var_plots <- var_models(final_data_3,
c('savings_station', 'unemp_station'),
out_months = out_months,
response = 'suicide24_sa_station',
runs=runs,
against_self=F,
clean=clean_names)
grid <- grid.arrange(grobs=temp_var_plots, nrow=2,top='')
ggsave(here('Plots', 'age24commonEconomic_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
temp_var_plots <- var_models(final_data_3,
c('ment24_sa_station', 'gen24_station', 'apple_station', 'divorced_station', 'savings_station', 'unemp_station'),
out_months = out_months,
response = 'suicide24_sa_station',
runs=runs,
against_self=T,
clean=clean_names)
height <- 7
width <- 11.5
grid <- grid.arrange(grobs=temp_var_plots, nrow=3,top='')
ggsave(here('Plots', 'age24all_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
## 25 and older
height <- 6
width <- 11.5
temp_var_plots <- var_models(final_data_3,
c('gen25_station', 'ment25_sa_station'),
out_months = out_months,
response = 'suicide25_sa_station',
runs=runs,
against_self=T,
clean=clean_names)
grid <- grid.arrange(grobs=temp_var_plots, nrow=1,top='')
ggsave(here('Plots', 'age25only_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
temp_var_plots <- var_models(final_data_3,
c('ment25_sa_station', 'gen25_station'),
out_months = out_months,
response = 'suicide25_sa_station',
runs=runs,
against_self=T,
clean=clean_names)
grid <- grid.arrange(grobs=temp_var_plots, nrow=1,top='')
ggsave(here('Plots', 'age25only_reverse_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
temp_var_plots <- var_models(final_data_3,
c('apple_station', 'atandt_station', 'verizon_station', 'divorced_station'),
out_months = out_months,
response = 'suicide25_sa_station',
runs=runs,
against_self=F,
clean=clean_names)
grid <- grid.arrange(grobs=temp_var_plots, nrow=2,top='')
ggsave(here('Plots', 'age25commonSocietal_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
temp_var_plots <- var_models(final_data_3,
c('savings_station', 'unemp_station'),
out_months = out_months,
response = 'suicide25_sa_station',
runs=runs,
against_self=F,
clean=clean_names)
grid <- grid.arrange(grobs=temp_var_plots, nrow=2,top='')
ggsave(here('Plots', 'age25commonEconomic_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
temp_var_plots <- var_models(final_data_3,
c('ment25_sa_station', 'gen25_station', 'apple_station', 'divorced_station', 'savings_station', 'unemp_station'),
out_months = out_months,
response = 'suicide25_sa_station',
runs=runs,
against_self=T,
clean=clean_names)
height <- 7
width <- 11.5
grid <- grid.arrange(grobs=temp_var_plots, nrow=3,top='')
ggsave(here('Plots', 'age25all_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
temp_var_plots_1 <- var_models(final_data_3,
c('suicide24_sa_station'),
out_months = out_months,
response = 'suicide25_sa_station',
runs=runs,
against_self=F,
clean=clean_names)
temp_var_plots_2 <- var_models(final_data_3,
c('suicide25_sa_station'),
out_months = out_months,
response = 'suicide24_sa_station',
runs=runs,
against_self=F,
clean=clean_names)
temp_list <- c(list(temp_var_plots_1[[1]] +  scale_y_continuous(labels = percent, limits=c(-0.02,0.02))),
list(temp_var_plots_2[[1]] +  scale_y_continuous(labels = percent, limits=c(-0.02,0.02))))
grid <- grid.arrange(grobs=temp_list, nrow=1,top='')
ggsave(here('Plots', 'suicideOnly_VAR.png'),plot=grid,dpi=300, width = width, height = height, units='in')
# try some arma models
max_lag <- 24
ardl_aic <- c()
ardl_models <- c()
for(i in 1:max_lag){
temp_ARDL <- dynlm(suicide24_sa_station ~
L(suicide24_sa_station, 1:i) +
L(gen24_station, 0:i) +
L(divorced_station, 0:i) +
L(apple_station, 0:i) +
L(unemp_station, 0:i) +
L(savings_station, 0:i) +
L(ment24_sa_station, 0:i)
, data = ts_final_data)
ardl_models <- append(ardl_models, list(temp_ARDL))
ardl_aic <- append(ardl_aic, abs(AIC(temp_ARDL)))
}
ardl_aic_tibble <- tibble(lag=1:max_lag, aic=ardl_aic)
best_model_num <- which.min(ardl_aic)
aic_plot <- ggplot(ardl_aic_tibble, aes(x=lag, y=aic)) +
geom_line() +
geom_point() +
geom_point(data=NULL, aes(x=best_model_num, y=ardl_aic[best_model_num]), color='red', size=4) +
main_theme +
scale_x_continuous(breaks=seq(from=2, to=max_lag, by =2)) +
labs(title='AIC For Various Lags for Adolescent ADRL Models (Lowest AIC in Red)', x='Lag', y='AIC')
aic_plot
ggsave(here('Plots', 'age24_arma_aic.png'),plot=aic_plot,dpi=300, width = 11.5, height = 9, units='in')
best_model_coef <- coef(summary(ardl_models[[best_model_num]]))
best_model_tibble <- bind_cols(var_name=rownames(best_model_coef), as_tibble(best_model_coef)) %>%
clean_names() %>%
mutate(Lag =  rep(seq(0,which.min(ardl_aic)),9))
best_model_pretty_table <- best_model_tibble %>%
mutate(pretty_var_name =  gsub('L\\(','',gsub(',.*','',var_name))) %>%
left_join(clean_names, by=c('pretty_var_name'='var_name')) %>%
mutate(clean_name = if_else(is.na(clean_name),'Intercept', clean_name)) %>%
filter(pr_t<=0.05) %>%
rename('P-value' = pr_t,
'Estimate'=estimate,
'Standard Error'=std_error,
'Test Statistic'=t_value,
'Variable Name'=clean_name) %>%
dplyr::select('Variable Name',
'Lag',
'Estimate',
'Test Statistic',
'Standard Error',
'P-value') %>%
mutate_if(is.numeric, ~round(.,4)) %>%
gt()
gt::gtsave(best_model_pretty_table,here('Plots', 'age24_arma_best_coef.png'))
# over 25
max_lag <- 24
ardl_aic <- c()
ardl_models <- c()
for(i in 1:max_lag){
temp_ARDL <- dynlm(suicide25_sa_station ~
L(suicide25_sa_station, 1:i) +
L(gen25_station, 0:i) +
L(divorced_station, 0:i) +
L(apple_station, 0:i) +
L(unemp_station, 0:i) +
L(savings_station, 0:i) +
L(ment25_sa_station, 0:i)
, data = ts_final_data)
ardl_models <- append(ardl_models, list(temp_ARDL))
ardl_aic <- append(ardl_aic, abs(AIC(temp_ARDL)))
}
ardl_aic_tibble <- tibble(lag=1:max_lag, aic=ardl_aic)
best_model_num <- which.min(ardl_aic)
aic_plot <- ggplot(ardl_aic_tibble, aes(x=lag, y=aic)) +
geom_line() +
geom_point() +
geom_point(data=NULL, aes(x=best_model_num, y=ardl_aic[best_model_num]), color='red', size=4) +
main_theme +
scale_x_continuous(breaks=seq(from=2, to=max_lag, by =2)) +
labs(title='AIC For Various Lags for Adult ADRL Models (Lowest AIC in Red)', x='Lag', y='AIC')
aic_plot
ggsave(here('Plots', 'age25_arma_aic.png'),plot=aic_plot,dpi=300, width = 11.5, height = 9, units='in')
best_model_coef <- coef(summary(ardl_models[[best_model_num]]))
best_model_tibble <- bind_cols(var_name=rownames(best_model_coef), as_tibble(best_model_coef)) %>%
clean_names() %>%
mutate(Lag =  rep(seq(0,which.min(ardl_aic)),9))
best_model_pretty_table <- best_model_tibble %>%
mutate(pretty_var_name =  gsub('L\\(','',gsub(',.*','',var_name))) %>%
left_join(clean_names, by=c('pretty_var_name'='var_name')) %>%
mutate(clean_name = if_else(is.na(clean_name),'Intercept', clean_name)) %>%
filter(pr_t<=0.05) %>%
rename('P-value' = pr_t,
'Estimate'=estimate,
'Standard Error'=std_error,
'Test Statistic'=t_value,
'Variable Name'=clean_name) %>%
dplyr::select('Variable Name',
'Lag',
'Estimate',
'Test Statistic',
'Standard Error',
'P-value') %>%
mutate_if(is.numeric, ~round(.,4)) %>%
gt()
gt::gtsave(best_model_pretty_table,here('Plots', 'age25_arma_best_coef.png'))
max_lag <- 24
ardl_aic <- c()
ardl_models <- c()
for(i in 1:max_lag){
temp_ARDL <- dynlm(suicide24_sa_station ~
L(suicide24_sa_station, 1:i) +
L(gen24_station, 0:i) +
L(divorced_station, 0:i) +
L(apple_station, 0:i) +
L(unemp_station, 0:i) +
L(savings_station, 0:i) +
L(ment24_sa_station, 0:i)
, data = ts_final_data)
ardl_models <- append(ardl_models, list(temp_ARDL))
ardl_aic <- append(ardl_aic, abs(AIC(temp_ARDL)))
}
ardl_aic_tibble <- tibble(lag=1:max_lag, aic=ardl_aic)
best_model_num <- which.min(ardl_aic)
aic_plot <- ggplot(ardl_aic_tibble, aes(x=lag, y=aic)) +
geom_line() +
geom_point() +
geom_point(data=NULL, aes(x=best_model_num, y=ardl_aic[best_model_num]), color='red', size=4) +
main_theme +
scale_x_continuous(breaks=seq(from=2, to=max_lag, by =2)) +
labs(title='AIC For Various Lags for Adolescent ADRL Models (Lowest AIC in Red)', x='Lag', y='AIC')
aic_plot
ggsave(here('Plots', 'age24_arma_aic.png'),plot=aic_plot,dpi=300, width = 11.5, height = 9, units='in')
best_model_coef <- coef(summary(ardl_models[[best_model_num]]))
best_model_tibble <- bind_cols(var_name=rownames(best_model_coef), as_tibble(best_model_coef)) %>%
clean_names() %>%
mutate(Lag =  rep(seq(0,which.min(ardl_aic)),9))
best_model_pretty_table <- best_model_tibble %>%
mutate(pretty_var_name =  gsub('L\\(','',gsub(',.*','',var_name))) %>%
left_join(clean_names, by=c('pretty_var_name'='var_name')) %>%
mutate(clean_name = if_else(is.na(clean_name),'Intercept', clean_name)) %>%
filter(pr_t<=0.05) %>%
rename('P-value' = pr_t,
'Estimate'=estimate,
'Standard Error'=std_error,
'Test Statistic'=t_value,
'Variable Name'=clean_name) %>%
dplyr::select('Variable Name',
'Lag',
'Estimate',
'Test Statistic',
'Standard Error',
'P-value') %>%
mutate_if(is.numeric, ~round(.,4)) %>%
gt()
gt::gtsave(best_model_pretty_table,here('Plots', 'age24_arma_best_coef.png'))
View(best_model_tibble)
View(best_model_tibble)
View(best_model_coef)
View(best_model_tibble)
max_lag <- 24
ardl_aic <- c()
ardl_models <- c()
for(i in 1:max_lag){
temp_ARDL <- dynlm(suicide24_sa_station ~
L(suicide24_sa_station, 1:i) +
L(gen24_station, 0:i) +
L(divorced_station, 0:i) +
L(apple_station, 0:i) +
L(unemp_station, 0:i) +
L(savings_station, 0:i) +
L(ment24_sa_station, 0:i)
, data = ts_final_data)
ardl_models <- append(ardl_models, list(temp_ARDL))
ardl_aic <- append(ardl_aic, abs(AIC(temp_ARDL)))
}
ardl_aic_tibble <- tibble(lag=1:max_lag, aic=ardl_aic)
best_model_num <- which.min(ardl_aic)
aic_plot <- ggplot(ardl_aic_tibble, aes(x=lag, y=aic)) +
geom_line() +
geom_point() +
geom_point(data=NULL, aes(x=best_model_num, y=ardl_aic[best_model_num]), color='red', size=4) +
main_theme +
scale_x_continuous(breaks=seq(from=2, to=max_lag, by =2)) +
labs(title='AIC For Various Lags for Adolescent ADRL Models (Lowest AIC in Red)', x='Lag', y='AIC')
aic_plot
ggsave(here('Plots', 'age24_arma_aic.png'),plot=aic_plot,dpi=300, width = 11.5, height = 9, units='in')
best_model_coef <- coef(summary(ardl_models[[best_model_num]]))
best_model_tibble <- bind_cols(var_name=rownames(best_model_coef), as_tibble(best_model_coef)) %>%
clean_names() %>%
mutate(Lag =  rep(seq(0,which.min(ardl_aic)),9))
View(temp_ARDL)
max_lag <- 24
ardl_aic <- c()
ardl_models <- c()
for(i in 1:max_lag){
temp_ARDL <- dynlm(suicide24_sa_station ~
L(suicide24_sa_station, 1:i) +
L(gen24_station, 0:i) +
L(divorced_station, 0:i) +
L(apple_station, 0:i) +
L(unemp_station, 0:i) +
L(savings_station, 0:i) +
L(ment24_sa_station, 0:i)
, data = ts_final_data)
ardl_models <- append(ardl_models, list(temp_ARDL))
ardl_aic <- append(ardl_aic, abs(AIC(temp_ARDL)))
}
ardl_aic_tibble <- tibble(lag=1:max_lag, aic=ardl_aic)
best_model_num <- which.min(ardl_aic)
aic_plot <- ggplot(ardl_aic_tibble, aes(x=lag, y=aic)) +
geom_line() +
geom_point() +
geom_point(data=NULL, aes(x=best_model_num, y=ardl_aic[best_model_num]), color='red', size=4) +
main_theme +
scale_x_continuous(breaks=seq(from=2, to=max_lag, by =2)) +
labs(title='AIC For Various Lags for Adolescent ADRL Models (Lowest AIC in Red)', x='Lag', y='AIC')
aic_plot
ggsave(here('Plots', 'age24_arma_aic.png'),plot=aic_plot,dpi=300, width = 11.5, height = 9, units='in')
best_model_coef <- coef(summary(ardl_models[[best_model_num]]))
best_model_tibble <- bind_cols(var_name=rownames(best_model_coef), as_tibble(best_model_coef)) %>%
clean_names() %>%
mutate(Lag =  rep(seq(0,which.min(ardl_aic)),7))
best_model_pretty_table <- best_model_tibble %>%
mutate(pretty_var_name =  gsub('L\\(','',gsub(',.*','',var_name))) %>%
left_join(clean_names, by=c('pretty_var_name'='var_name')) %>%
mutate(clean_name = if_else(is.na(clean_name),'Intercept', clean_name)) %>%
filter(pr_t<=0.05) %>%
rename('P-value' = pr_t,
'Estimate'=estimate,
'Standard Error'=std_error,
'Test Statistic'=t_value,
'Variable Name'=clean_name) %>%
dplyr::select('Variable Name',
'Lag',
'Estimate',
'Test Statistic',
'Standard Error',
'P-value') %>%
mutate_if(is.numeric, ~round(.,4)) %>%
gt()
gt::gtsave(best_model_pretty_table,here('Plots', 'age24_arma_best_coef.png'))
# over 25
max_lag <- 24
ardl_aic <- c()
ardl_models <- c()
for(i in 1:max_lag){
temp_ARDL <- dynlm(suicide25_sa_station ~
L(suicide25_sa_station, 1:i) +
L(gen25_station, 0:i) +
L(divorced_station, 0:i) +
L(apple_station, 0:i) +
L(unemp_station, 0:i) +
L(savings_station, 0:i) +
L(ment25_sa_station, 0:i)
, data = ts_final_data)
ardl_models <- append(ardl_models, list(temp_ARDL))
ardl_aic <- append(ardl_aic, abs(AIC(temp_ARDL)))
}
ardl_aic_tibble <- tibble(lag=1:max_lag, aic=ardl_aic)
best_model_num <- which.min(ardl_aic)
aic_plot <- ggplot(ardl_aic_tibble, aes(x=lag, y=aic)) +
geom_line() +
geom_point() +
geom_point(data=NULL, aes(x=best_model_num, y=ardl_aic[best_model_num]), color='red', size=4) +
main_theme +
scale_x_continuous(breaks=seq(from=2, to=max_lag, by =2)) +
labs(title='AIC For Various Lags for Adult ADRL Models (Lowest AIC in Red)', x='Lag', y='AIC')
aic_plot
ggsave(here('Plots', 'age25_arma_aic.png'),plot=aic_plot,dpi=300, width = 11.5, height = 9, units='in')
best_model_coef <- coef(summary(ardl_models[[best_model_num]]))
best_model_tibble <- bind_cols(var_name=rownames(best_model_coef), as_tibble(best_model_coef)) %>%
clean_names() %>%
mutate(Lag =  rep(seq(0,which.min(ardl_aic)),7))
best_model_pretty_table <- best_model_tibble %>%
mutate(pretty_var_name =  gsub('L\\(','',gsub(',.*','',var_name))) %>%
left_join(clean_names, by=c('pretty_var_name'='var_name')) %>%
mutate(clean_name = if_else(is.na(clean_name),'Intercept', clean_name)) %>%
filter(pr_t<=0.05) %>%
rename('P-value' = pr_t,
'Estimate'=estimate,
'Standard Error'=std_error,
'Test Statistic'=t_value,
'Variable Name'=clean_name) %>%
dplyr::select('Variable Name',
'Lag',
'Estimate',
'Test Statistic',
'Standard Error',
'P-value') %>%
mutate_if(is.numeric, ~round(.,4)) %>%
gt()
gt::gtsave(best_model_pretty_table,here('Plots', 'age25_arma_best_coef.png'))
